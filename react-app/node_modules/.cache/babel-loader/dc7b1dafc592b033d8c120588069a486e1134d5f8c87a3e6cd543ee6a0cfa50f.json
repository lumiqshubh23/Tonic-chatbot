{"ast":null,"code":"import _taggedTemplateLiteral from\"/home/shubham/Documents/Personal/my-project/react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject0,_templateObject1,_templateObject10,_templateObject11,_templateObject12,_templateObject13,_templateObject14,_templateObject15,_templateObject16,_templateObject17,_templateObject18,_templateObject19;import React,{useState,useRef,useEffect}from'react';import FileUpload from'./FileUpload';import ChatMessage from'./ChatMessage';import{Send,Paperclip,X}from'lucide-react';import styled from'styled-components';import toast from'react-hot-toast';import{fileAPI,chatAPI,chatHistoryAPI}from'../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ChatContainer=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  height: calc(100vh - 105px);\\n  background: #f7fafc;\\n\"])));const FileUploadSection=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  margin: 20px;\\n  background: white;\\n  border-radius: 12px;\\n  padding: 20px;\\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\\n  border: 1px solid #e2e8f0;\\n\"])));const ChatSection=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  flex: 1;\\n  display: flex;\\n  flex-direction: column;\\n  overflow: hidden;\\n  min-height: 0;\\n\"])));const MessagesContainer=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n  flex: 1;\\n  overflow-y: auto;\\n  padding: 20px;\\n  display: flex;\\n  flex-direction: column;\\n  gap: 0;\\n  background: #f7fafc;\\n  min-height: 0;\\n  max-height: calc(100vh - 200px);\\n\"])));const InputSection=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n  padding: 24px;\\n  background: white;\\n  border-top: 1px solid #e2e8f0;\\n  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);\\n  position: sticky;\\n  bottom: 0;\\n  z-index: 10;\\n  flex-shrink: 0;\\n  transition: all 0.2s ease;\\n  min-height: 80px;\\n  display: flex;\\n  align-items: center;\\n\"])));const InputForm=styled.form(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n  display: flex;\\n  gap: 12px;\\n  align-items: flex-end;\\n  width: 100%;\\n  flex: 1;\\n\"])));const TextArea=styled.textarea(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n  flex: 1;\\n  padding: 16px 20px;\\n  border: 1px solid #e2e8f0;\\n  border-radius: 12px;\\n  font-size: 16px;\\n  font-family: inherit;\\n  resize: none;\\n  min-height: 60px;\\n  max-height: 200px;\\n  background: white;\\n  transition: all 0.2s ease;\\n  overflow-y: auto;\\n  line-height: 1.5;\\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\\n  \\n  &:focus {\\n    outline: none;\\n    border-color: #FF6B35;\\n    box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);\\n  }\\n  \\n  &::placeholder {\\n    color: #a0aec0;\\n  }\\n\"])));const SendButton=styled.button(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n  padding: 16px 24px;\\n  background: linear-gradient(135deg, #FF6B35 0%, #e53e3e 100%);\\n  color: white;\\n  border: none;\\n  border-radius: 12px;\\n  cursor: pointer;\\n  transition: all 0.2s ease;\\n  display: flex;\\n  align-items: center;\\n  gap: 8px;\\n  font-weight: 600;\\n  font-size: 14px;\\n  min-height: 48px;\\n  white-space: nowrap;\\n  \\n  &:hover {\\n    transform: translateY(-1px);\\n    box-shadow: 0 10px 25px rgba(255, 107, 53, 0.3);\\n  }\\n  \\n  &:disabled {\\n    opacity: 0.6;\\n    cursor: not-allowed;\\n    transform: none;\\n  }\\n\"])));const UploadButton=styled.button(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n  padding: 16px;\\n  background: none;\\n  border: none;\\n  color: #718096;\\n  cursor: pointer;\\n  border-radius: 8px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  transition: all 0.2s ease;\\n  min-width: 48px;\\n  height: 48px;\\n  \\n  &:hover {\\n    background: #f7fafc;\\n    color: #FF6B35;\\n  }\\n  \\n  &:disabled {\\n    opacity: 0.5;\\n    cursor: not-allowed;\\n  }\\n\"])));const UploadInterface=styled.div(_templateObject0||(_templateObject0=_taggedTemplateLiteral([\"\\n  position: absolute;\\n  bottom: 100%;\\n  left: 0;\\n  right: 0;\\n  background: white;\\n  border: 1px solid #e2e8f0;\\n  border-radius: 12px;\\n  box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);\\n  margin-bottom: 10px;\\n  z-index: 20;\\n  animation: slideUp 0.2s ease;\\n  \\n  @keyframes slideUp {\\n    from {\\n      opacity: 0;\\n      transform: translateY(10px);\\n    }\\n    to {\\n      opacity: 1;\\n      transform: translateY(0);\\n    }\\n  }\\n\"])));const UploadHeader=styled.div(_templateObject1||(_templateObject1=_taggedTemplateLiteral([\"\\n  display: flex;\\n  align-items: center;\\n  justify-content: space-between;\\n  padding: 16px 20px;\\n  border-bottom: 1px solid #e2e8f0;\\n\"])));const UploadTitle=styled.h4(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n  color: #2d3748;\\n  margin: 0;\\n  font-weight: 600;\\n  font-size: 16px;\\n\"])));const CloseButton=styled.button(_templateObject11||(_templateObject11=_taggedTemplateLiteral([\"\\n  background: none;\\n  border: none;\\n  color: #718096;\\n  cursor: pointer;\\n  padding: 4px;\\n  border-radius: 4px;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  \\n  &:hover {\\n    background: #f7fafc;\\n    color: #e53e3e;\\n  }\\n\"])));const InputWrapper=styled.div(_templateObject12||(_templateObject12=_taggedTemplateLiteral([\"\\n  position: relative;\\n  display: flex;\\n  gap: 12px;\\n  align-items: flex-end;\\n  width: 100%;\\n\"])));const EmptyState=styled.div(_templateObject13||(_templateObject13=_taggedTemplateLiteral([\"\\n  text-align: center;\\n  padding: 60px 20px;\\n  color: #718096;\\n  \\n  h3 {\\n    margin-bottom: 12px;\\n    color: #4a5568;\\n    font-weight: 600;\\n  }\\n  \\n  p {\\n    margin-bottom: 20px;\\n    font-size: 16px;\\n  }\\n\"])));const LoadingContainer=styled.div(_templateObject14||(_templateObject14=_taggedTemplateLiteral([\"\\n  text-align: center;\\n  padding: 40px 20px;\\n  color: #718096;\\n  \\n  .spinner {\\n    margin: 0 auto 16px auto;\\n  }\\n  \\n  p {\\n    font-size: 16px;\\n    margin: 0;\\n  }\\n\"])));const KnowledgeBaseStatus=styled.div(_templateObject15||(_templateObject15=_taggedTemplateLiteral([\"\\n  margin: 20px;\\n  padding: 16px;\\n  background: white;\\n  border-radius: 12px;\\n  border: 1px solid #e2e8f0;\\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\\n\"])));const StatusHeader=styled.div(_templateObject16||(_templateObject16=_taggedTemplateLiteral([\"\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  margin-bottom: 12px;\\n\"])));const StatusTitle=styled.h4(_templateObject17||(_templateObject17=_taggedTemplateLiteral([\"\\n  color: #2d3748;\\n  margin: 0;\\n  font-weight: 600;\\n  font-size: 16px;\\n\"])));const ClearButton=styled.button(_templateObject18||(_templateObject18=_taggedTemplateLiteral([\"\\n  padding: 6px 12px;\\n  background: #e53e3e;\\n  color: white;\\n  border: none;\\n  border-radius: 6px;\\n  cursor: pointer;\\n  font-size: 12px;\\n  font-weight: 500;\\n  transition: all 0.2s ease;\\n  \\n  &:hover {\\n    background: #c53030;\\n  }\\n\"])));const StatusText=styled.p(_templateObject19||(_templateObject19=_taggedTemplateLiteral([\"\\n  color: #718096;\\n  margin: 0;\\n  font-size: 14px;\\n\"])));function ChatInterface(_ref){let{currentSessionId,currentSessionData,onSessionChange}=_ref;const[userInput,setUserInput]=useState('');const[isLoading,setIsLoading]=useState(false);const[isUploading,setIsUploading]=useState(false);const[knowledgeBase,setKnowledgeBase]=useState('');const[showFileUpload,setShowFileUpload]=useState(false);const[showUploadInterface,setShowUploadInterface]=useState(false);const[messages,setMessages]=useState([]);const[loadingMessages,setLoadingMessages]=useState(false);const messagesEndRef=useRef(null);const textareaRef=useRef(null);const scrollToBottom=()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:\"smooth\"});};const loadSessionMessages=async()=>{if(!currentSessionId)return;try{setLoadingMessages(true);const response=await chatHistoryAPI.getSessionHistory(currentSessionId);if(response.success){// Convert database messages to the format expected by ChatMessage component\nconst formattedMessages=response.session.messages.map(msg=>({q:msg.question,a:msg.answer,timestamp:msg.timestamp,type:'ai'}));setMessages(formattedMessages);}else{toast.error('Failed to load session messages');}}catch(error){console.error('Load session messages error:',error);toast.error('Failed to load session messages');}finally{setLoadingMessages(false);}};// Auto-resize textarea function\nconst adjustTextareaHeight=()=>{const textarea=textareaRef.current;if(textarea){textarea.style.height='auto';const newHeight=Math.min(textarea.scrollHeight,200);textarea.style.height=\"\".concat(newHeight,\"px\");}};// Load messages when session changes\nuseEffect(()=>{if(currentSessionId){loadSessionMessages();}else{setMessages([]);}},[currentSessionId]);useEffect(()=>{scrollToBottom();},[messages]);// Adjust textarea height when userInput changes\nuseEffect(()=>{adjustTextareaHeight();},[userInput]);// Monitor for Chrome extension interference\nuseEffect(()=>{const originalFetch=window.fetch;const originalXHROpen=XMLHttpRequest.prototype.open;// Monitor fetch requests\nwindow.fetch=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}const url=args[0];if(typeof url==='string'&&url.includes('chrome-extension://')){var _args$;console.warn('Chrome extension request detected:',{url,method:((_args$=args[1])===null||_args$===void 0?void 0:_args$.method)||'GET',timestamp:new Date().toISOString(),stack:new Error().stack});}return originalFetch.apply(this,args);};// Monitor XMLHttpRequest\nXMLHttpRequest.prototype.open=function(method,url){if(typeof url==='string'&&url.includes('chrome-extension://')){console.warn('Chrome extension XMLHttpRequest detected:',{url,method,timestamp:new Date().toISOString(),stack:new Error().stack});}for(var _len2=arguments.length,args=new Array(_len2>2?_len2-2:0),_key2=2;_key2<_len2;_key2++){args[_key2-2]=arguments[_key2];}return originalXHROpen.apply(this,[method,url,...args]);};// Cleanup function\nreturn()=>{window.fetch=originalFetch;XMLHttpRequest.prototype.open=originalXHROpen;};},[]);const handleKeyDown=e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSubmit(e);}};// Add handlers to detect and potentially mitigate Chrome extension interference\nconst handleFocus=e=>{// Log focus events to help debug extension issues\nconsole.log('TextArea focused',{target:e.target,timestamp:new Date().toISOString(),userAgent:navigator.userAgent});};const handleBlur=e=>{// Log blur events to help debug extension issues\nconsole.log('TextArea blurred',{target:e.target,timestamp:new Date().toISOString()});};const handleInput=e=>{// Prevent potential extension interference by ensuring proper event handling\nsetUserInput(e.target.value);adjustTextareaHeight();};const handleSubmit=async e=>{e.preventDefault();if(!userInput.trim()||isLoading||!currentSessionId)return;const question=userInput.trim();setUserInput('');setIsLoading(true);// Add user message to local state\nconst userMessage={q:question,a:'',timestamp:new Date().toLocaleString(),type:'user'};setMessages(prev=>[...prev,userMessage]);try{console.log('Sending message to API:',{question,knowledgeBase:knowledgeBase?'Present':'Empty',sessionId:currentSessionId,currentSessionName:currentSessionData===null||currentSessionData===void 0?void 0:currentSessionData.session_name});// Get AI response from backend\nconst response=await chatAPI.sendMessage(question,knowledgeBase,messages,(currentSessionData===null||currentSessionData===void 0?void 0:currentSessionData.session_name)||'Default');if(response.success){var _response$response,_response$tables,_response$plot,_response$plot_code,_response$sources;// Add AI response as a separate message\nconst aiMessage={q:'',a:response.response,timestamp:response.timestamp,type:'ai',tables:response.tables||[],plot:response.plot,plot_code:response.plot_code,sources:response.sources};// Debug logging\nconsole.log('🤖 AI Response received:',{responseLength:(_response$response=response.response)===null||_response$response===void 0?void 0:_response$response.length,tablesCount:((_response$tables=response.tables)===null||_response$tables===void 0?void 0:_response$tables.length)||0,hasPlot:!!response.plot,plotLength:((_response$plot=response.plot)===null||_response$plot===void 0?void 0:_response$plot.length)||0,hasPlotCode:!!response.plot_code,plotCodeLength:((_response$plot_code=response.plot_code)===null||_response$plot_code===void 0?void 0:_response$plot_code.length)||0,sourcesCount:((_response$sources=response.sources)===null||_response$sources===void 0?void 0:_response$sources.length)||0});// Additional plot debugging\nif(response.plot){console.log('🎨 Plot data received:',{plotDataLength:response.plot.length,plotDataPreview:response.plot.substring(0,100)+'...'});}if(response.plot_code){console.log('📝 Plot code received:',{plotCodeLength:response.plot_code.length,plotCodePreview:response.plot_code.substring(0,200)+'...'});}setMessages(prev=>[...prev,aiMessage]);}else{toast.error('Failed to get response from AI');}}catch(error){toast.error('Failed to get response. Please try again.');console.error('Error:',error);}finally{setIsLoading(false);}};const handleFileUpload=async files=>{setIsUploading(true);try{const response=await fileAPI.upload(files);if(response.success){setKnowledgeBase(response.knowledge_base);toast.success(response.message);setShowUploadInterface(false);}else{toast.error('Failed to process files');}}catch(error){console.error('File upload error:',error);toast.error('Failed to upload files. Please try again.');}finally{setIsUploading(false);}};const clearKnowledgeBase=()=>{setKnowledgeBase('');toast.success('Knowledge base cleared');};// This line is no longer needed as we're using the messages state directly\nreturn/*#__PURE__*/_jsxs(ChatContainer,{children:[knowledgeBase&&/*#__PURE__*/_jsxs(KnowledgeBaseStatus,{children:[/*#__PURE__*/_jsxs(StatusHeader,{children:[/*#__PURE__*/_jsx(StatusTitle,{children:\"\\uD83D\\uDCDA Knowledge Base Active\"}),/*#__PURE__*/_jsx(ClearButton,{onClick:clearKnowledgeBase,children:\"Clear\"})]}),/*#__PURE__*/_jsxs(StatusText,{children:[\"Knowledge base contains \",knowledgeBase.length,\" characters\"]})]}),/*#__PURE__*/_jsxs(ChatSection,{children:[/*#__PURE__*/_jsxs(MessagesContainer,{children:[!currentSessionId?/*#__PURE__*/_jsxs(EmptyState,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Welcome to TONIC AI! \\uD83E\\uDD16\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Select a chat session from the sidebar or create a new one to start chatting.\"})]}):loadingMessages?/*#__PURE__*/_jsxs(EmptyState,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\",style:{width:'32px',height:'32px',margin:'0 auto 16px'}}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading messages...\"})]}):messages.length===0?/*#__PURE__*/_jsxs(EmptyState,{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Start a New Conversation! \\uD83E\\uDD16\"}),/*#__PURE__*/_jsx(\"p\",{children:knowledgeBase?\"Ask a question about your uploaded documents to begin.\":\"Upload some documents to build your knowledge base, then start asking questions!\"})]}):messages.map((message,index)=>/*#__PURE__*/_jsx(ChatMessage,{message:message},index)),isLoading&&/*#__PURE__*/_jsxs(LoadingContainer,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\",style:{width:'32px',height:'32px'}}),/*#__PURE__*/_jsx(\"p\",{children:\"Generating response...\"})]}),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsx(InputSection,{children:/*#__PURE__*/_jsxs(InputWrapper,{children:[showUploadInterface&&/*#__PURE__*/_jsxs(UploadInterface,{children:[/*#__PURE__*/_jsxs(UploadHeader,{children:[/*#__PURE__*/_jsx(UploadTitle,{children:\"\\uD83D\\uDCC1 Upload Documents\"}),/*#__PURE__*/_jsx(CloseButton,{onClick:()=>setShowUploadInterface(false),children:/*#__PURE__*/_jsx(X,{size:20})})]}),/*#__PURE__*/_jsx(FileUpload,{onFileUpload:handleFileUpload,isUploading:isUploading})]}),/*#__PURE__*/_jsxs(InputForm,{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(UploadButton,{type:\"button\",onClick:()=>setShowUploadInterface(!showUploadInterface),disabled:isLoading,title:\"Upload documents\",children:/*#__PURE__*/_jsx(Paperclip,{size:20})}),/*#__PURE__*/_jsx(TextArea,{ref:textareaRef,value:userInput,onChange:handleInput,onFocus:handleFocus,onBlur:handleBlur,onKeyDown:handleKeyDown,placeholder:!currentSessionId?\"Select a chat session to start messaging...\":knowledgeBase?\"Ask me anything about your uploaded documents or any general question...\":\"Upload documents first to ask questions about them...\",disabled:isLoading// Add attributes to help prevent extension interference\n,autoComplete:\"off\",spellCheck:\"false\",\"data-gramm\":\"false\",\"data-gramm_editor\":\"false\",\"data-enable-grammarly\":\"false\"}),/*#__PURE__*/_jsxs(SendButton,{type:\"submit\",disabled:isLoading||!userInput.trim()||!currentSessionId,children:[isLoading?/*#__PURE__*/_jsx(\"div\",{className:\"spinner\",style:{width:'20px',height:'20px'}}):/*#__PURE__*/_jsx(Send,{size:20}),\"Send\"]})]})]})})]})]});}export default ChatInterface;","map":{"version":3,"names":["React","useState","useRef","useEffect","FileUpload","ChatMessage","Send","Paperclip","X","styled","toast","fileAPI","chatAPI","chatHistoryAPI","jsx","_jsx","jsxs","_jsxs","ChatContainer","div","_templateObject","_taggedTemplateLiteral","FileUploadSection","_templateObject2","ChatSection","_templateObject3","MessagesContainer","_templateObject4","InputSection","_templateObject5","InputForm","form","_templateObject6","TextArea","textarea","_templateObject7","SendButton","button","_templateObject8","UploadButton","_templateObject9","UploadInterface","_templateObject0","UploadHeader","_templateObject1","UploadTitle","h4","_templateObject10","CloseButton","_templateObject11","InputWrapper","_templateObject12","EmptyState","_templateObject13","LoadingContainer","_templateObject14","KnowledgeBaseStatus","_templateObject15","StatusHeader","_templateObject16","StatusTitle","_templateObject17","ClearButton","_templateObject18","StatusText","p","_templateObject19","ChatInterface","_ref","currentSessionId","currentSessionData","onSessionChange","userInput","setUserInput","isLoading","setIsLoading","isUploading","setIsUploading","knowledgeBase","setKnowledgeBase","showFileUpload","setShowFileUpload","showUploadInterface","setShowUploadInterface","messages","setMessages","loadingMessages","setLoadingMessages","messagesEndRef","textareaRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","loadSessionMessages","response","getSessionHistory","success","formattedMessages","session","map","msg","q","question","a","answer","timestamp","type","error","console","adjustTextareaHeight","style","height","newHeight","Math","min","scrollHeight","concat","originalFetch","window","fetch","originalXHROpen","XMLHttpRequest","prototype","open","_len","arguments","length","args","Array","_key","url","includes","_args$","warn","method","Date","toISOString","stack","Error","apply","_len2","_key2","handleKeyDown","e","key","shiftKey","preventDefault","handleSubmit","handleFocus","log","target","userAgent","navigator","handleBlur","handleInput","value","trim","userMessage","toLocaleString","prev","sessionId","currentSessionName","session_name","sendMessage","_response$response","_response$tables","_response$plot","_response$plot_code","_response$sources","aiMessage","tables","plot","plot_code","sources","responseLength","tablesCount","hasPlot","plotLength","hasPlotCode","plotCodeLength","sourcesCount","plotDataLength","plotDataPreview","substring","plotCodePreview","handleFileUpload","files","upload","knowledge_base","message","clearKnowledgeBase","children","onClick","className","width","margin","index","ref","size","onFileUpload","onSubmit","disabled","title","onChange","onFocus","onBlur","onKeyDown","placeholder","autoComplete","spellCheck"],"sources":["/home/shubham/Documents/Personal/my-project/react-app/src/components/ChatInterface.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport FileUpload from './FileUpload';\nimport ChatMessage from './ChatMessage';\nimport { Send, Paperclip, X } from 'lucide-react';\nimport styled from 'styled-components';\nimport toast from 'react-hot-toast';\nimport { fileAPI, chatAPI, chatHistoryAPI } from '../services/api';\n\nconst ChatContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: calc(100vh - 105px);\n  background: #f7fafc;\n`;\n\nconst FileUploadSection = styled.div`\n  margin: 20px;\n  background: white;\n  border-radius: 12px;\n  padding: 20px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  border: 1px solid #e2e8f0;\n`;\n\nconst ChatSection = styled.div`\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  min-height: 0;\n`;\n\nconst MessagesContainer = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  padding: 20px;\n  display: flex;\n  flex-direction: column;\n  gap: 0;\n  background: #f7fafc;\n  min-height: 0;\n  max-height: calc(100vh - 200px);\n`;\n\nconst InputSection = styled.div`\n  padding: 24px;\n  background: white;\n  border-top: 1px solid #e2e8f0;\n  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);\n  position: sticky;\n  bottom: 0;\n  z-index: 10;\n  flex-shrink: 0;\n  transition: all 0.2s ease;\n  min-height: 80px;\n  display: flex;\n  align-items: center;\n`;\n\nconst InputForm = styled.form`\n  display: flex;\n  gap: 12px;\n  align-items: flex-end;\n  width: 100%;\n  flex: 1;\n`;\n\nconst TextArea = styled.textarea`\n  flex: 1;\n  padding: 16px 20px;\n  border: 1px solid #e2e8f0;\n  border-radius: 12px;\n  font-size: 16px;\n  font-family: inherit;\n  resize: none;\n  min-height: 60px;\n  max-height: 200px;\n  background: white;\n  transition: all 0.2s ease;\n  overflow-y: auto;\n  line-height: 1.5;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  \n  &:focus {\n    outline: none;\n    border-color: #FF6B35;\n    box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);\n  }\n  \n  &::placeholder {\n    color: #a0aec0;\n  }\n`;\n\nconst SendButton = styled.button`\n  padding: 16px 24px;\n  background: linear-gradient(135deg, #FF6B35 0%, #e53e3e 100%);\n  color: white;\n  border: none;\n  border-radius: 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-weight: 600;\n  font-size: 14px;\n  min-height: 48px;\n  white-space: nowrap;\n  \n  &:hover {\n    transform: translateY(-1px);\n    box-shadow: 0 10px 25px rgba(255, 107, 53, 0.3);\n  }\n  \n  &:disabled {\n    opacity: 0.6;\n    cursor: not-allowed;\n    transform: none;\n  }\n`;\n\nconst UploadButton = styled.button`\n  padding: 16px;\n  background: none;\n  border: none;\n  color: #718096;\n  cursor: pointer;\n  border-radius: 8px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n  min-width: 48px;\n  height: 48px;\n  \n  &:hover {\n    background: #f7fafc;\n    color: #FF6B35;\n  }\n  \n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n`;\n\nconst UploadInterface = styled.div`\n  position: absolute;\n  bottom: 100%;\n  left: 0;\n  right: 0;\n  background: white;\n  border: 1px solid #e2e8f0;\n  border-radius: 12px;\n  box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.1);\n  margin-bottom: 10px;\n  z-index: 20;\n  animation: slideUp 0.2s ease;\n  \n  @keyframes slideUp {\n    from {\n      opacity: 0;\n      transform: translateY(10px);\n    }\n    to {\n      opacity: 1;\n      transform: translateY(0);\n    }\n  }\n`;\n\nconst UploadHeader = styled.div`\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 16px 20px;\n  border-bottom: 1px solid #e2e8f0;\n`;\n\nconst UploadTitle = styled.h4`\n  color: #2d3748;\n  margin: 0;\n  font-weight: 600;\n  font-size: 16px;\n`;\n\nconst CloseButton = styled.button`\n  background: none;\n  border: none;\n  color: #718096;\n  cursor: pointer;\n  padding: 4px;\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  \n  &:hover {\n    background: #f7fafc;\n    color: #e53e3e;\n  }\n`;\n\nconst InputWrapper = styled.div`\n  position: relative;\n  display: flex;\n  gap: 12px;\n  align-items: flex-end;\n  width: 100%;\n`;\n\nconst EmptyState = styled.div`\n  text-align: center;\n  padding: 60px 20px;\n  color: #718096;\n  \n  h3 {\n    margin-bottom: 12px;\n    color: #4a5568;\n    font-weight: 600;\n  }\n  \n  p {\n    margin-bottom: 20px;\n    font-size: 16px;\n  }\n`;\n\nconst LoadingContainer = styled.div`\n  text-align: center;\n  padding: 40px 20px;\n  color: #718096;\n  \n  .spinner {\n    margin: 0 auto 16px auto;\n  }\n  \n  p {\n    font-size: 16px;\n    margin: 0;\n  }\n`;\n\nconst KnowledgeBaseStatus = styled.div`\n  margin: 20px;\n  padding: 16px;\n  background: white;\n  border-radius: 12px;\n  border: 1px solid #e2e8f0;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n`;\n\nconst StatusHeader = styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 12px;\n`;\n\nconst StatusTitle = styled.h4`\n  color: #2d3748;\n  margin: 0;\n  font-weight: 600;\n  font-size: 16px;\n`;\n\nconst ClearButton = styled.button`\n  padding: 6px 12px;\n  background: #e53e3e;\n  color: white;\n  border: none;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 12px;\n  font-weight: 500;\n  transition: all 0.2s ease;\n  \n  &:hover {\n    background: #c53030;\n  }\n`;\n\nconst StatusText = styled.p`\n  color: #718096;\n  margin: 0;\n  font-size: 14px;\n`;\n\nfunction ChatInterface({ currentSessionId, currentSessionData, onSessionChange }) {\n  const [userInput, setUserInput] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [isUploading, setIsUploading] = useState(false);\n  const [knowledgeBase, setKnowledgeBase] = useState('');\n  const [showFileUpload, setShowFileUpload] = useState(false);\n  const [showUploadInterface, setShowUploadInterface] = useState(false);\n  const [messages, setMessages] = useState([]);\n  const [loadingMessages, setLoadingMessages] = useState(false);\n  const messagesEndRef = useRef(null);\n  const textareaRef = useRef(null);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  const loadSessionMessages = async () => {\n    if (!currentSessionId) return;\n    \n    try {\n      setLoadingMessages(true);\n      const response = await chatHistoryAPI.getSessionHistory(currentSessionId);\n      if (response.success) {\n        // Convert database messages to the format expected by ChatMessage component\n        const formattedMessages = response.session.messages.map(msg => ({\n          q: msg.question,\n          a: msg.answer,\n          timestamp: msg.timestamp,\n          type: 'ai'\n        }));\n        setMessages(formattedMessages);\n      } else {\n        toast.error('Failed to load session messages');\n      }\n    } catch (error) {\n      console.error('Load session messages error:', error);\n      toast.error('Failed to load session messages');\n    } finally {\n      setLoadingMessages(false);\n    }\n  };\n\n  // Auto-resize textarea function\n  const adjustTextareaHeight = () => {\n    const textarea = textareaRef.current;\n    if (textarea) {\n      textarea.style.height = 'auto';\n      const newHeight = Math.min(textarea.scrollHeight, 200);\n      textarea.style.height = `${newHeight}px`;\n    }\n  };\n\n  // Load messages when session changes\n  useEffect(() => {\n    if (currentSessionId) {\n      loadSessionMessages();\n    } else {\n      setMessages([]);\n    }\n  }, [currentSessionId]);\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  // Adjust textarea height when userInput changes\n  useEffect(() => {\n    adjustTextareaHeight();\n  }, [userInput]);\n\n  // Monitor for Chrome extension interference\n  useEffect(() => {\n    const originalFetch = window.fetch;\n    const originalXHROpen = XMLHttpRequest.prototype.open;\n    \n    // Monitor fetch requests\n    window.fetch = function(...args) {\n      const url = args[0];\n      if (typeof url === 'string' && url.includes('chrome-extension://')) {\n        console.warn('Chrome extension request detected:', {\n          url,\n          method: args[1]?.method || 'GET',\n          timestamp: new Date().toISOString(),\n          stack: new Error().stack\n        });\n      }\n      return originalFetch.apply(this, args);\n    };\n    \n    // Monitor XMLHttpRequest\n    XMLHttpRequest.prototype.open = function(method, url, ...args) {\n      if (typeof url === 'string' && url.includes('chrome-extension://')) {\n        console.warn('Chrome extension XMLHttpRequest detected:', {\n          url,\n          method,\n          timestamp: new Date().toISOString(),\n          stack: new Error().stack\n        });\n      }\n      return originalXHROpen.apply(this, [method, url, ...args]);\n    };\n    \n    // Cleanup function\n    return () => {\n      window.fetch = originalFetch;\n      XMLHttpRequest.prototype.open = originalXHROpen;\n    };\n  }, []);\n\n  const handleKeyDown = (e) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSubmit(e);\n    }\n  };\n\n  // Add handlers to detect and potentially mitigate Chrome extension interference\n  const handleFocus = (e) => {\n    // Log focus events to help debug extension issues\n    console.log('TextArea focused', {\n      target: e.target,\n      timestamp: new Date().toISOString(),\n      userAgent: navigator.userAgent\n    });\n  };\n\n  const handleBlur = (e) => {\n    // Log blur events to help debug extension issues\n    console.log('TextArea blurred', {\n      target: e.target,\n      timestamp: new Date().toISOString()\n    });\n  };\n\n  const handleInput = (e) => {\n    // Prevent potential extension interference by ensuring proper event handling\n    setUserInput(e.target.value);\n    adjustTextareaHeight();\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!userInput.trim() || isLoading || !currentSessionId) return;\n\n    const question = userInput.trim();\n    setUserInput('');\n    setIsLoading(true);\n\n    // Add user message to local state\n    const userMessage = {\n      q: question,\n      a: '',\n      timestamp: new Date().toLocaleString(),\n      type: 'user'\n    };\n\n    setMessages(prev => [...prev, userMessage]);\n\n    try {\n      console.log('Sending message to API:', {\n        question,\n        knowledgeBase: knowledgeBase ? 'Present' : 'Empty',\n        sessionId: currentSessionId,\n        currentSessionName: currentSessionData?.session_name\n      });\n      \n      // Get AI response from backend\n      const response = await chatAPI.sendMessage(\n        question, \n        knowledgeBase, \n        messages, \n        currentSessionData?.session_name || 'Default'\n      );\n      \n      if (response.success) {\n        // Add AI response as a separate message\n        const aiMessage = {\n          q: '',\n          a: response.response,\n          timestamp: response.timestamp,\n          type: 'ai',\n          tables: response.tables || [],\n          plot: response.plot,\n          plot_code: response.plot_code,\n          sources: response.sources\n        };\n\n        // Debug logging\n        console.log('🤖 AI Response received:', {\n          responseLength: response.response?.length,\n          tablesCount: response.tables?.length || 0,\n          hasPlot: !!response.plot,\n          plotLength: response.plot?.length || 0,\n          hasPlotCode: !!response.plot_code,\n          plotCodeLength: response.plot_code?.length || 0,\n          sourcesCount: response.sources?.length || 0\n        });\n        \n        // Additional plot debugging\n        if (response.plot) {\n          console.log('🎨 Plot data received:', {\n            plotDataLength: response.plot.length,\n            plotDataPreview: response.plot.substring(0, 100) + '...'\n          });\n        }\n        \n        if (response.plot_code) {\n          console.log('📝 Plot code received:', {\n            plotCodeLength: response.plot_code.length,\n            plotCodePreview: response.plot_code.substring(0, 200) + '...'\n          });\n        }\n\n        setMessages(prev => [...prev, aiMessage]);\n\n      } else {\n        toast.error('Failed to get response from AI');\n      }\n\n    } catch (error) {\n      toast.error('Failed to get response. Please try again.');\n      console.error('Error:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleFileUpload = async (files) => {\n    setIsUploading(true);\n    try {\n      const response = await fileAPI.upload(files);\n      if (response.success) {\n        setKnowledgeBase(response.knowledge_base);\n        toast.success(response.message);\n        setShowUploadInterface(false);\n      } else {\n        toast.error('Failed to process files');\n      }\n    } catch (error) {\n      console.error('File upload error:', error);\n      toast.error('Failed to upload files. Please try again.');\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  const clearKnowledgeBase = () => {\n    setKnowledgeBase('');\n    toast.success('Knowledge base cleared');\n  };\n\n  // This line is no longer needed as we're using the messages state directly\n\n  return (\n    <ChatContainer>\n      {knowledgeBase && (\n        <KnowledgeBaseStatus>\n          <StatusHeader>\n            <StatusTitle>📚 Knowledge Base Active</StatusTitle>\n            <ClearButton onClick={clearKnowledgeBase}>\n              Clear\n            </ClearButton>\n          </StatusHeader>\n          <StatusText>\n            Knowledge base contains {knowledgeBase.length} characters\n          </StatusText>\n        </KnowledgeBaseStatus>\n      )}\n\n      <ChatSection>\n        <MessagesContainer>\n          {!currentSessionId ? (\n            <EmptyState>\n              <h3>Welcome to TONIC AI! 🤖</h3>\n              <p>Select a chat session from the sidebar or create a new one to start chatting.</p>\n            </EmptyState>\n          ) : loadingMessages ? (\n            <EmptyState>\n              <div className=\"spinner\" style={{ width: '32px', height: '32px', margin: '0 auto 16px' }}></div>\n              <p>Loading messages...</p>\n            </EmptyState>\n          ) : messages.length === 0 ? (\n            <EmptyState>\n              <h3>Start a New Conversation! 🤖</h3>\n              <p>\n                {knowledgeBase \n                  ? \"Ask a question about your uploaded documents to begin.\"\n                  : \"Upload some documents to build your knowledge base, then start asking questions!\"\n                }\n              </p>\n            </EmptyState>\n          ) : (\n            messages.map((message, index) => (\n              <ChatMessage key={index} message={message} />\n            ))\n          )}\n          \n          {isLoading && (\n            <LoadingContainer>\n              <div className=\"spinner\" style={{ width: '32px', height: '32px' }}></div>\n              <p>Generating response...</p>\n            </LoadingContainer>\n          )}\n          \n          <div ref={messagesEndRef} />\n        </MessagesContainer>\n\n        <InputSection>\n          <InputWrapper>\n            {showUploadInterface && (\n              <UploadInterface>\n                <UploadHeader>\n                  <UploadTitle>📁 Upload Documents</UploadTitle>\n                  <CloseButton onClick={() => setShowUploadInterface(false)}>\n                    <X size={20} />\n                  </CloseButton>\n                </UploadHeader>\n                <FileUpload onFileUpload={handleFileUpload} isUploading={isUploading} />\n              </UploadInterface>\n            )}\n            \n            <InputForm onSubmit={handleSubmit}>\n              <UploadButton\n                type=\"button\"\n                onClick={() => setShowUploadInterface(!showUploadInterface)}\n                disabled={isLoading}\n                title=\"Upload documents\"\n              >\n                <Paperclip size={20} />\n              </UploadButton>\n              \n              <TextArea\n                ref={textareaRef}\n                value={userInput}\n                onChange={handleInput}\n                onFocus={handleFocus}\n                onBlur={handleBlur}\n                onKeyDown={handleKeyDown}\n                placeholder={\n                  !currentSessionId\n                    ? \"Select a chat session to start messaging...\"\n                    : knowledgeBase \n                    ? \"Ask me anything about your uploaded documents or any general question...\"\n                    : \"Upload documents first to ask questions about them...\"\n                }\n                disabled={isLoading}\n                // Add attributes to help prevent extension interference\n                autoComplete=\"off\"\n                spellCheck=\"false\"\n                data-gramm=\"false\"\n                data-gramm_editor=\"false\"\n                data-enable-grammarly=\"false\"\n              />\n              <SendButton type=\"submit\" disabled={isLoading || !userInput.trim() || !currentSessionId}>\n                {isLoading ? (\n                  <div className=\"spinner\" style={{ width: '20px', height: '20px' }}></div>\n                ) : (\n                  <Send size={20} />\n                )}\n                Send\n              </SendButton>\n            </InputForm>\n          </InputWrapper>\n        </InputSection>\n      </ChatSection>\n    </ChatContainer>\n  );\n}\n\nexport default ChatInterface;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}