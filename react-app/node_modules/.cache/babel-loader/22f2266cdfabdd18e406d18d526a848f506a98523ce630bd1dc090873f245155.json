{"ast":null,"code":"var _jsxFileName = \"/home/shubham/Documents/Personal/my-project/react-app/src/components/ChatInterface.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from 'react';\nimport FileUpload from './FileUpload';\nimport ChatMessage from './ChatMessage';\nimport { Send, ChevronDown, ChevronUp, Download, History } from 'lucide-react';\nimport styled from 'styled-components';\nimport toast from 'react-hot-toast';\nimport { fileAPI, chatAPI } from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChatContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  max-width: 1200px;\n  margin: 0 auto;\n  background: #f7fafc;\n`;\n_c = ChatContainer;\nconst FileUploadSection = styled.div`\n  margin: 20px;\n  background: white;\n  border-radius: 12px;\n  padding: 20px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  border: 1px solid #e2e8f0;\n`;\nconst ChatSection = styled.div`\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n`;\n_c2 = ChatSection;\nconst MessagesContainer = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  padding: 20px;\n  display: flex;\n  flex-direction: column;\n  gap: 0;\n  background: #f7fafc;\n`;\n_c3 = MessagesContainer;\nconst InputSection = styled.div`\n  padding: 20px;\n  background: white;\n  border-top: 1px solid #e2e8f0;\n  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);\n  position: sticky;\n  bottom: 0;\n  z-index: 10;\n`;\n_c4 = InputSection;\nconst InputForm = styled.form`\n  display: flex;\n  gap: 12px;\n  align-items: flex-end;\n  max-width: 800px;\n  margin: 0 auto;\n`;\n_c5 = InputForm;\nconst TextArea = styled.textarea`\n  flex: 1;\n  padding: 16px;\n  border: 1px solid #e2e8f0;\n  border-radius: 12px;\n  font-size: 16px;\n  font-family: inherit;\n  resize: vertical;\n  min-height: 60px;\n  max-height: 200px;\n  background: white;\n  transition: all 0.2s ease;\n  \n  &:focus {\n    outline: none;\n    border-color: #FF6B35;\n    box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);\n  }\n  \n  &::placeholder {\n    color: #a0aec0;\n  }\n`;\n_c6 = TextArea;\nconst SendButton = styled.button`\n  padding: 16px 24px;\n  background: linear-gradient(135deg, #FF6B35 0%, #e53e3e 100%);\n  color: white;\n  border: none;\n  border-radius: 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-weight: 600;\n  font-size: 14px;\n  \n  &:hover {\n    transform: translateY(-1px);\n    box-shadow: 0 10px 25px rgba(255, 107, 53, 0.3);\n  }\n  \n  &:disabled {\n    opacity: 0.6;\n    cursor: not-allowed;\n    transform: none;\n  }\n`;\n_c7 = SendButton;\nconst EmptyState = styled.div`\n  text-align: center;\n  padding: 60px 20px;\n  color: #718096;\n  \n  h3 {\n    margin-bottom: 12px;\n    color: #4a5568;\n    font-weight: 600;\n  }\n  \n  p {\n    margin-bottom: 20px;\n    font-size: 16px;\n  }\n`;\n_c8 = EmptyState;\nconst LoadingContainer = styled.div`\n  text-align: center;\n  padding: 40px 20px;\n  color: #718096;\n  \n  .spinner {\n    margin: 0 auto 16px auto;\n  }\n  \n  p {\n    font-size: 16px;\n    margin: 0;\n  }\n`;\n_c9 = LoadingContainer;\nconst ChatHistorySection = styled.div`\n  margin: 20px;\n  background: white;\n  border-radius: 12px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  border: 1px solid #e2e8f0;\n  overflow: hidden;\n`;\n_c0 = ChatHistorySection;\nconst HistoryHeader = styled.div`\n  padding: 16px 20px;\n  background: #f8f9fa;\n  border-bottom: 1px solid #e2e8f0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n`;\n_c1 = HistoryHeader;\nconst HistoryTitle = styled.h3`\n  color: #2d3748;\n  margin: 0;\n  font-weight: 600;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n`;\n_c10 = HistoryTitle;\nconst HistoryControls = styled.div`\n  display: flex;\n  gap: 12px;\n  align-items: center;\n`;\n_c11 = HistoryControls;\nconst ToggleButton = styled.button`\n  padding: 8px 12px;\n  background: #FF6B35;\n  color: white;\n  border: none;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 0.9rem;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-weight: 500;\n  transition: all 0.2s ease;\n  \n  &:hover {\n    background: #e53e3e;\n    transform: translateY(-1px);\n  }\n`;\n_c12 = ToggleButton;\nconst ExportButton = styled.button`\n  padding: 8px 12px;\n  background: #38a169;\n  color: white;\n  border: none;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 0.9rem;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-weight: 500;\n  transition: all 0.2s ease;\n  \n  &:hover {\n    background: #2f855a;\n    transform: translateY(-1px);\n  }\n`;\n_c13 = ExportButton;\nconst HistoryContent = styled.div`\n  max-height: ${props => props.isOpen ? '400px' : '0'};\n  overflow: hidden;\n  transition: max-height 0.3s ease;\n`;\n_c14 = HistoryContent;\nconst HistoryMessages = styled.div`\n  padding: 20px;\n  max-height: 400px;\n  overflow-y: auto;\n`;\n_c15 = HistoryMessages;\nconst HistoryMessage = styled.div`\n  margin-bottom: 16px;\n  border: 1px solid #e2e8f0;\n  border-radius: 8px;\n  overflow: hidden;\n`;\n_c16 = HistoryMessage;\nconst MessageHeader = styled.div`\n  padding: 12px 16px;\n  background: #f8f9fa;\n  border-bottom: 1px solid #e2e8f0;\n  cursor: pointer;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  transition: background-color 0.2s ease;\n  \n  &:hover {\n    background: #edf2f7;\n  }\n`;\n_c17 = MessageHeader;\nconst MessageTitle = styled.div`\n  font-weight: 500;\n  color: #4a5568;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n`;\n_c18 = MessageTitle;\nconst MessageTimestamp = styled.span`\n  font-size: 0.8rem;\n  color: #718096;\n`;\n_c19 = MessageTimestamp;\nconst MessageContent = styled.div`\n  padding: 16px;\n  background: white;\n  max-height: ${props => props.isExpanded ? 'none' : '0'};\n  overflow: hidden;\n  transition: all 0.3s ease;\n`;\n_c20 = MessageContent;\nconst MessageText = styled.div`\n  margin-bottom: 12px;\n  \n  h4 {\n    color: #2d3748;\n    margin: 0 0 8px 0;\n    font-size: 14px;\n    font-weight: 600;\n  }\n  \n  p {\n    color: #4a5568;\n    margin: 0;\n    line-height: 1.6;\n  }\n`;\n_c21 = MessageText;\nfunction ChatInterface({\n  currentSession,\n  sessions,\n  setSessions\n}) {\n  _s();\n  const [userInput, setUserInput] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [knowledgeBase, setKnowledgeBase] = useState('');\n  const [showHistory, setShowHistory] = useState(true);\n  const [expandedMessages, setExpandedMessages] = useState({});\n  const messagesEndRef = useRef(null);\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  };\n  useEffect(() => {\n    scrollToBottom();\n  }, [sessions[currentSession]]);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    if (!userInput.trim() || isLoading) return;\n    const question = userInput.trim();\n    setUserInput('');\n    setIsLoading(true);\n\n    // Add user message to session\n    const newMessage = {\n      q: question,\n      a: '',\n      timestamp: new Date().toLocaleString(),\n      type: 'user'\n    };\n    setSessions(prev => ({\n      ...prev,\n      [currentSession]: [...prev[currentSession], newMessage]\n    }));\n    try {\n      // Get AI response from backend\n      const response = await chatAPI.sendMessage(question, knowledgeBase, sessions[currentSession], currentSession);\n      if (response.success) {\n        // Add AI response to session\n        const aiMessage = {\n          q: question,\n          a: response.response,\n          timestamp: response.timestamp,\n          type: 'ai',\n          tables: response.tables || [],\n          plot: response.plot\n        };\n        setSessions(prev => ({\n          ...prev,\n          [currentSession]: prev[currentSession].map((msg, index) => index === prev[currentSession].length - 1 ? aiMessage : msg)\n        }));\n      } else {\n        toast.error('Failed to get response from AI');\n      }\n    } catch (error) {\n      toast.error('Failed to get response. Please try again.');\n      console.error('Error:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  const handleFileUpload = async files => {\n    try {\n      const response = await fileAPI.upload(files);\n      if (response.success) {\n        setKnowledgeBase(response.knowledge_base);\n        toast.success(response.message);\n      } else {\n        toast.error('Failed to process files');\n      }\n    } catch (error) {\n      console.error('File upload error:', error);\n      toast.error('Failed to upload files. Please try again.');\n    }\n  };\n  const toggleMessage = index => {\n    setExpandedMessages(prev => ({\n      ...prev,\n      [index]: !prev[index]\n    }));\n  };\n  const exportChatHistory = () => {\n    const currentSessionMessages = sessions[currentSession] || [];\n    if (currentSessionMessages.length === 0) {\n      toast.error('No chat history to export');\n      return;\n    }\n    let chatExport = \"\";\n    currentSessionMessages.forEach((msg, i) => {\n      const timestamp = msg.timestamp || 'No timestamp';\n      chatExport += `=== Message ${i + 1} | ${timestamp} ===\\n`;\n      chatExport += `User: ${msg.q}\\n\\n`;\n      chatExport += `Assistant: ${msg.a}\\n\\n`;\n      chatExport += \"-\".repeat(50) + \"\\n\\n\";\n    });\n    const blob = new Blob([chatExport], {\n      type: 'text/plain'\n    });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `chat_history_${currentSession}_${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.txt`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n    toast.success('Chat history exported successfully!');\n  };\n  const currentSessionMessages = sessions[currentSession] || [];\n  return /*#__PURE__*/_jsxDEV(ChatContainer, {\n    children: [/*#__PURE__*/_jsxDEV(ChatSection, {\n      children: [/*#__PURE__*/_jsxDEV(MessagesContainer, {\n        children: [currentSessionMessages.length === 0 ? /*#__PURE__*/_jsxDEV(EmptyState, {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Welcome to TONIC AI! \\uD83E\\uDD16\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 425,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Start a conversation by asking a question or upload some documents to get started.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 426,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 424,\n          columnNumber: 13\n        }, this) : currentSessionMessages.map((message, index) => /*#__PURE__*/_jsxDEV(ChatMessage, {\n          message: message\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 430,\n          columnNumber: 15\n        }, this)), isLoading && /*#__PURE__*/_jsxDEV(LoadingContainer, {\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"spinner\",\n            style: {\n              width: '32px',\n              height: '32px'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 436,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"Generating response...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 437,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 435,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: messagesEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 441,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 422,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(InputSection, {\n        children: /*#__PURE__*/_jsxDEV(InputForm, {\n          onSubmit: handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(TextArea, {\n            value: userInput,\n            onChange: e => setUserInput(e.target.value),\n            placeholder: \"Ask me anything about your uploaded documents or any general question...\",\n            disabled: isLoading\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 446,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(SendButton, {\n            type: \"submit\",\n            disabled: isLoading || !userInput.trim(),\n            children: [isLoading ? /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"spinner\",\n              style: {\n                width: '20px',\n                height: '20px'\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 454,\n              columnNumber: 17\n            }, this) : /*#__PURE__*/_jsxDEV(Send, {\n              size: 20\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 456,\n              columnNumber: 17\n            }, this), \"Send\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 452,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 445,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 444,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 421,\n      columnNumber: 7\n    }, this), currentSessionMessages.length > 0 && /*#__PURE__*/_jsxDEV(ChatHistorySection, {\n      children: [/*#__PURE__*/_jsxDEV(HistoryHeader, {\n        children: [/*#__PURE__*/_jsxDEV(HistoryTitle, {\n          children: [/*#__PURE__*/_jsxDEV(History, {\n            size: 20\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 469,\n            columnNumber: 15\n          }, this), \"Chat History: \", currentSession]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 468,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(HistoryControls, {\n          children: [/*#__PURE__*/_jsxDEV(ToggleButton, {\n            onClick: () => setShowHistory(!showHistory),\n            children: [showHistory ? /*#__PURE__*/_jsxDEV(ChevronUp, {\n              size: 16\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 474,\n              columnNumber: 32\n            }, this) : /*#__PURE__*/_jsxDEV(ChevronDown, {\n              size: 16\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 474,\n              columnNumber: 58\n            }, this), showHistory ? 'Hide' : 'Show', \" History\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 473,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(ExportButton, {\n            onClick: exportChatHistory,\n            children: [/*#__PURE__*/_jsxDEV(Download, {\n              size: 16\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 478,\n              columnNumber: 17\n            }, this), \"Export\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 477,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 472,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 467,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(HistoryContent, {\n        isOpen: showHistory,\n        children: /*#__PURE__*/_jsxDEV(HistoryMessages, {\n          children: currentSessionMessages.map((message, index) => /*#__PURE__*/_jsxDEV(HistoryMessage, {\n            children: [/*#__PURE__*/_jsxDEV(MessageHeader, {\n              onClick: () => toggleMessage(index),\n              children: [/*#__PURE__*/_jsxDEV(MessageTitle, {\n                children: [\"\\uD83D\\uDCAC Message \", index + 1, \": \", message.q.substring(0, 50), \"...\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 489,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(MessageTimestamp, {\n                children: [message.timestamp, expandedMessages[index] ? /*#__PURE__*/_jsxDEV(ChevronUp, {\n                  size: 16\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 494,\n                  columnNumber: 50\n                }, this) : /*#__PURE__*/_jsxDEV(ChevronDown, {\n                  size: 16\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 494,\n                  columnNumber: 76\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 492,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 488,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(MessageContent, {\n              isExpanded: expandedMessages[index],\n              children: [/*#__PURE__*/_jsxDEV(MessageText, {\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: \"\\uD83D\\uDE4B User:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 499,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: message.q\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 500,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 498,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(MessageText, {\n                children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                  children: \"\\uD83E\\uDD16 Assistant:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 503,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: message.a\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 504,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 502,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 497,\n              columnNumber: 19\n            }, this)]\n          }, index, true, {\n            fileName: _jsxFileName,\n            lineNumber: 487,\n            columnNumber: 17\n          }, this))\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 485,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 484,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 466,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 416,\n    columnNumber: 5\n  }, this);\n}\n_s(ChatInterface, \"93UuMHf5Lj1eWaAjhcAEaTYn2nA=\");\n_c22 = ChatInterface;\nexport default ChatInterface;\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c0, _c1, _c10, _c11, _c12, _c13, _c14, _c15, _c16, _c17, _c18, _c19, _c20, _c21, _c22;\n$RefreshReg$(_c, \"ChatContainer\");\n$RefreshReg$(_c2, \"ChatSection\");\n$RefreshReg$(_c3, \"MessagesContainer\");\n$RefreshReg$(_c4, \"InputSection\");\n$RefreshReg$(_c5, \"InputForm\");\n$RefreshReg$(_c6, \"TextArea\");\n$RefreshReg$(_c7, \"SendButton\");\n$RefreshReg$(_c8, \"EmptyState\");\n$RefreshReg$(_c9, \"LoadingContainer\");\n$RefreshReg$(_c0, \"ChatHistorySection\");\n$RefreshReg$(_c1, \"HistoryHeader\");\n$RefreshReg$(_c10, \"HistoryTitle\");\n$RefreshReg$(_c11, \"HistoryControls\");\n$RefreshReg$(_c12, \"ToggleButton\");\n$RefreshReg$(_c13, \"ExportButton\");\n$RefreshReg$(_c14, \"HistoryContent\");\n$RefreshReg$(_c15, \"HistoryMessages\");\n$RefreshReg$(_c16, \"HistoryMessage\");\n$RefreshReg$(_c17, \"MessageHeader\");\n$RefreshReg$(_c18, \"MessageTitle\");\n$RefreshReg$(_c19, \"MessageTimestamp\");\n$RefreshReg$(_c20, \"MessageContent\");\n$RefreshReg$(_c21, \"MessageText\");\n$RefreshReg$(_c22, \"ChatInterface\");","map":{"version":3,"names":["React","useState","useRef","useEffect","FileUpload","ChatMessage","Send","ChevronDown","ChevronUp","Download","History","styled","toast","fileAPI","chatAPI","jsxDEV","_jsxDEV","ChatContainer","div","_c","FileUploadSection","ChatSection","_c2","MessagesContainer","_c3","InputSection","_c4","InputForm","form","_c5","TextArea","textarea","_c6","SendButton","button","_c7","EmptyState","_c8","LoadingContainer","_c9","ChatHistorySection","_c0","HistoryHeader","_c1","HistoryTitle","h3","_c10","HistoryControls","_c11","ToggleButton","_c12","ExportButton","_c13","HistoryContent","props","isOpen","_c14","HistoryMessages","_c15","HistoryMessage","_c16","MessageHeader","_c17","MessageTitle","_c18","MessageTimestamp","span","_c19","MessageContent","isExpanded","_c20","MessageText","_c21","ChatInterface","currentSession","sessions","setSessions","_s","userInput","setUserInput","isLoading","setIsLoading","knowledgeBase","setKnowledgeBase","showHistory","setShowHistory","expandedMessages","setExpandedMessages","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","handleSubmit","e","preventDefault","trim","question","newMessage","q","a","timestamp","Date","toLocaleString","type","prev","response","sendMessage","success","aiMessage","tables","plot","map","msg","index","length","error","console","handleFileUpload","files","upload","knowledge_base","message","toggleMessage","exportChatHistory","currentSessionMessages","chatExport","forEach","i","repeat","blob","Blob","url","window","URL","createObjectURL","document","createElement","href","download","toISOString","slice","replace","click","revokeObjectURL","children","fileName","_jsxFileName","lineNumber","columnNumber","className","style","width","height","ref","onSubmit","value","onChange","target","placeholder","disabled","size","onClick","substring","_c22","$RefreshReg$"],"sources":["/home/shubham/Documents/Personal/my-project/react-app/src/components/ChatInterface.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\nimport FileUpload from './FileUpload';\nimport ChatMessage from './ChatMessage';\nimport { Send, ChevronDown, ChevronUp, Download, History } from 'lucide-react';\nimport styled from 'styled-components';\nimport toast from 'react-hot-toast';\nimport { fileAPI, chatAPI } from '../services/api';\n\nconst ChatContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  max-width: 1200px;\n  margin: 0 auto;\n  background: #f7fafc;\n`;\n\nconst FileUploadSection = styled.div`\n  margin: 20px;\n  background: white;\n  border-radius: 12px;\n  padding: 20px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  border: 1px solid #e2e8f0;\n`;\n\nconst ChatSection = styled.div`\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n`;\n\nconst MessagesContainer = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  padding: 20px;\n  display: flex;\n  flex-direction: column;\n  gap: 0;\n  background: #f7fafc;\n`;\n\nconst InputSection = styled.div`\n  padding: 20px;\n  background: white;\n  border-top: 1px solid #e2e8f0;\n  box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);\n  position: sticky;\n  bottom: 0;\n  z-index: 10;\n`;\n\nconst InputForm = styled.form`\n  display: flex;\n  gap: 12px;\n  align-items: flex-end;\n  max-width: 800px;\n  margin: 0 auto;\n`;\n\nconst TextArea = styled.textarea`\n  flex: 1;\n  padding: 16px;\n  border: 1px solid #e2e8f0;\n  border-radius: 12px;\n  font-size: 16px;\n  font-family: inherit;\n  resize: vertical;\n  min-height: 60px;\n  max-height: 200px;\n  background: white;\n  transition: all 0.2s ease;\n  \n  &:focus {\n    outline: none;\n    border-color: #FF6B35;\n    box-shadow: 0 0 0 3px rgba(255, 107, 53, 0.1);\n  }\n  \n  &::placeholder {\n    color: #a0aec0;\n  }\n`;\n\nconst SendButton = styled.button`\n  padding: 16px 24px;\n  background: linear-gradient(135deg, #FF6B35 0%, #e53e3e 100%);\n  color: white;\n  border: none;\n  border-radius: 12px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  font-weight: 600;\n  font-size: 14px;\n  \n  &:hover {\n    transform: translateY(-1px);\n    box-shadow: 0 10px 25px rgba(255, 107, 53, 0.3);\n  }\n  \n  &:disabled {\n    opacity: 0.6;\n    cursor: not-allowed;\n    transform: none;\n  }\n`;\n\nconst EmptyState = styled.div`\n  text-align: center;\n  padding: 60px 20px;\n  color: #718096;\n  \n  h3 {\n    margin-bottom: 12px;\n    color: #4a5568;\n    font-weight: 600;\n  }\n  \n  p {\n    margin-bottom: 20px;\n    font-size: 16px;\n  }\n`;\n\nconst LoadingContainer = styled.div`\n  text-align: center;\n  padding: 40px 20px;\n  color: #718096;\n  \n  .spinner {\n    margin: 0 auto 16px auto;\n  }\n  \n  p {\n    font-size: 16px;\n    margin: 0;\n  }\n`;\n\nconst ChatHistorySection = styled.div`\n  margin: 20px;\n  background: white;\n  border-radius: 12px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  border: 1px solid #e2e8f0;\n  overflow: hidden;\n`;\n\nconst HistoryHeader = styled.div`\n  padding: 16px 20px;\n  background: #f8f9fa;\n  border-bottom: 1px solid #e2e8f0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n`;\n\nconst HistoryTitle = styled.h3`\n  color: #2d3748;\n  margin: 0;\n  font-weight: 600;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n`;\n\nconst HistoryControls = styled.div`\n  display: flex;\n  gap: 12px;\n  align-items: center;\n`;\n\nconst ToggleButton = styled.button`\n  padding: 8px 12px;\n  background: #FF6B35;\n  color: white;\n  border: none;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 0.9rem;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-weight: 500;\n  transition: all 0.2s ease;\n  \n  &:hover {\n    background: #e53e3e;\n    transform: translateY(-1px);\n  }\n`;\n\nconst ExportButton = styled.button`\n  padding: 8px 12px;\n  background: #38a169;\n  color: white;\n  border: none;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 0.9rem;\n  display: flex;\n  align-items: center;\n  gap: 4px;\n  font-weight: 500;\n  transition: all 0.2s ease;\n  \n  &:hover {\n    background: #2f855a;\n    transform: translateY(-1px);\n  }\n`;\n\nconst HistoryContent = styled.div`\n  max-height: ${props => props.isOpen ? '400px' : '0'};\n  overflow: hidden;\n  transition: max-height 0.3s ease;\n`;\n\nconst HistoryMessages = styled.div`\n  padding: 20px;\n  max-height: 400px;\n  overflow-y: auto;\n`;\n\nconst HistoryMessage = styled.div`\n  margin-bottom: 16px;\n  border: 1px solid #e2e8f0;\n  border-radius: 8px;\n  overflow: hidden;\n`;\n\nconst MessageHeader = styled.div`\n  padding: 12px 16px;\n  background: #f8f9fa;\n  border-bottom: 1px solid #e2e8f0;\n  cursor: pointer;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  transition: background-color 0.2s ease;\n  \n  &:hover {\n    background: #edf2f7;\n  }\n`;\n\nconst MessageTitle = styled.div`\n  font-weight: 500;\n  color: #4a5568;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n`;\n\nconst MessageTimestamp = styled.span`\n  font-size: 0.8rem;\n  color: #718096;\n`;\n\nconst MessageContent = styled.div`\n  padding: 16px;\n  background: white;\n  max-height: ${props => props.isExpanded ? 'none' : '0'};\n  overflow: hidden;\n  transition: all 0.3s ease;\n`;\n\nconst MessageText = styled.div`\n  margin-bottom: 12px;\n  \n  h4 {\n    color: #2d3748;\n    margin: 0 0 8px 0;\n    font-size: 14px;\n    font-weight: 600;\n  }\n  \n  p {\n    color: #4a5568;\n    margin: 0;\n    line-height: 1.6;\n  }\n`;\n\nfunction ChatInterface({ currentSession, sessions, setSessions }) {\n  const [userInput, setUserInput] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [knowledgeBase, setKnowledgeBase] = useState('');\n  const [showHistory, setShowHistory] = useState(true);\n  const [expandedMessages, setExpandedMessages] = useState({});\n  const messagesEndRef = useRef(null);\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [sessions[currentSession]]);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (!userInput.trim() || isLoading) return;\n\n    const question = userInput.trim();\n    setUserInput('');\n    setIsLoading(true);\n\n    // Add user message to session\n    const newMessage = {\n      q: question,\n      a: '',\n      timestamp: new Date().toLocaleString(),\n      type: 'user'\n    };\n\n    setSessions(prev => ({\n      ...prev,\n      [currentSession]: [...prev[currentSession], newMessage]\n    }));\n\n    try {\n      // Get AI response from backend\n      const response = await chatAPI.sendMessage(\n        question, \n        knowledgeBase, \n        sessions[currentSession], \n        currentSession\n      );\n      \n      if (response.success) {\n        // Add AI response to session\n        const aiMessage = {\n          q: question,\n          a: response.response,\n          timestamp: response.timestamp,\n          type: 'ai',\n          tables: response.tables || [],\n          plot: response.plot\n        };\n\n        setSessions(prev => ({\n          ...prev,\n          [currentSession]: prev[currentSession].map((msg, index) => \n            index === prev[currentSession].length - 1 ? aiMessage : msg\n          )\n        }));\n\n      } else {\n        toast.error('Failed to get response from AI');\n      }\n\n    } catch (error) {\n      toast.error('Failed to get response. Please try again.');\n      console.error('Error:', error);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleFileUpload = async (files) => {\n    try {\n      const response = await fileAPI.upload(files);\n      if (response.success) {\n        setKnowledgeBase(response.knowledge_base);\n        toast.success(response.message);\n      } else {\n        toast.error('Failed to process files');\n      }\n    } catch (error) {\n      console.error('File upload error:', error);\n      toast.error('Failed to upload files. Please try again.');\n    }\n  };\n\n  const toggleMessage = (index) => {\n    setExpandedMessages(prev => ({\n      ...prev,\n      [index]: !prev[index]\n    }));\n  };\n\n  const exportChatHistory = () => {\n    const currentSessionMessages = sessions[currentSession] || [];\n    if (currentSessionMessages.length === 0) {\n      toast.error('No chat history to export');\n      return;\n    }\n\n    let chatExport = \"\";\n    currentSessionMessages.forEach((msg, i) => {\n      const timestamp = msg.timestamp || 'No timestamp';\n      chatExport += `=== Message ${i+1} | ${timestamp} ===\\n`;\n      chatExport += `User: ${msg.q}\\n\\n`;\n      chatExport += `Assistant: ${msg.a}\\n\\n`;\n      chatExport += \"-\".repeat(50) + \"\\n\\n\";\n    });\n\n    const blob = new Blob([chatExport], { type: 'text/plain' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `chat_history_${currentSession}_${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.txt`;\n    a.click();\n    window.URL.revokeObjectURL(url);\n    toast.success('Chat history exported successfully!');\n  };\n\n  const currentSessionMessages = sessions[currentSession] || [];\n\n  return (\n    <ChatContainer>\n      {/* <FileUploadSection>\n        <FileUpload onFileUpload={handleFileUpload} />\n      </FileUploadSection> */}\n\n      <ChatSection>\n        <MessagesContainer>\n          {currentSessionMessages.length === 0 ? (\n            <EmptyState>\n              <h3>Welcome to TONIC AI! ðŸ¤–</h3>\n              <p>Start a conversation by asking a question or upload some documents to get started.</p>\n            </EmptyState>\n          ) : (\n            currentSessionMessages.map((message, index) => (\n              <ChatMessage key={index} message={message} />\n            ))\n          )}\n          \n          {isLoading && (\n            <LoadingContainer>\n              <div className=\"spinner\" style={{ width: '32px', height: '32px' }}></div>\n              <p>Generating response...</p>\n            </LoadingContainer>\n          )}\n          \n          <div ref={messagesEndRef} />\n        </MessagesContainer>\n\n        <InputSection>\n          <InputForm onSubmit={handleSubmit}>\n            <TextArea\n              value={userInput}\n              onChange={(e) => setUserInput(e.target.value)}\n              placeholder=\"Ask me anything about your uploaded documents or any general question...\"\n              disabled={isLoading}\n            />\n            <SendButton type=\"submit\" disabled={isLoading || !userInput.trim()}>\n              {isLoading ? (\n                <div className=\"spinner\" style={{ width: '20px', height: '20px' }}></div>\n              ) : (\n                <Send size={20} />\n              )}\n              Send\n            </SendButton>\n          </InputForm>\n        </InputSection>\n      </ChatSection>\n\n      {/* Chat History Section */}\n      {currentSessionMessages.length > 0 && (\n        <ChatHistorySection>\n          <HistoryHeader>\n            <HistoryTitle>\n              <History size={20} />\n              Chat History: {currentSession}\n            </HistoryTitle>\n            <HistoryControls>\n              <ToggleButton onClick={() => setShowHistory(!showHistory)}>\n                {showHistory ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n                {showHistory ? 'Hide' : 'Show'} History\n              </ToggleButton>\n              <ExportButton onClick={exportChatHistory}>\n                <Download size={16} />\n                Export\n              </ExportButton>\n            </HistoryControls>\n          </HistoryHeader>\n          \n          <HistoryContent isOpen={showHistory}>\n            <HistoryMessages>\n              {currentSessionMessages.map((message, index) => (\n                <HistoryMessage key={index}>\n                  <MessageHeader onClick={() => toggleMessage(index)}>\n                    <MessageTitle>\n                      ðŸ’¬ Message {index + 1}: {message.q.substring(0, 50)}...\n                    </MessageTitle>\n                    <MessageTimestamp>\n                      {message.timestamp}\n                      {expandedMessages[index] ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\n                    </MessageTimestamp>\n                  </MessageHeader>\n                  <MessageContent isExpanded={expandedMessages[index]}>\n                    <MessageText>\n                      <h4>ðŸ™‹ User:</h4>\n                      <p>{message.q}</p>\n                    </MessageText>\n                    <MessageText>\n                      <h4>ðŸ¤– Assistant:</h4>\n                      <p>{message.a}</p>\n                    </MessageText>\n                  </MessageContent>\n                </HistoryMessage>\n              ))}\n            </HistoryMessages>\n          </HistoryContent>\n        </ChatHistorySection>\n      )}\n    </ChatContainer>\n  );\n}\n\nexport default ChatInterface;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,MAAM,EAAEC,SAAS,QAAQ,OAAO;AAC1D,OAAOC,UAAU,MAAM,cAAc;AACrC,OAAOC,WAAW,MAAM,eAAe;AACvC,SAASC,IAAI,EAAEC,WAAW,EAAEC,SAAS,EAAEC,QAAQ,EAAEC,OAAO,QAAQ,cAAc;AAC9E,OAAOC,MAAM,MAAM,mBAAmB;AACtC,OAAOC,KAAK,MAAM,iBAAiB;AACnC,SAASC,OAAO,EAAEC,OAAO,QAAQ,iBAAiB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEnD,MAAMC,aAAa,GAAGN,MAAM,CAACO,GAAG;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACC,EAAA,GAPIF,aAAa;AASnB,MAAMG,iBAAiB,GAAGT,MAAM,CAACO,GAAG;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAED,MAAMG,WAAW,GAAGV,MAAM,CAACO,GAAG;AAC9B;AACA;AACA;AACA;AACA,CAAC;AAACI,GAAA,GALID,WAAW;AAOjB,MAAME,iBAAiB,GAAGZ,MAAM,CAACO,GAAG;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACM,GAAA,GARID,iBAAiB;AAUvB,MAAME,YAAY,GAAGd,MAAM,CAACO,GAAG;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACQ,GAAA,GARID,YAAY;AAUlB,MAAME,SAAS,GAAGhB,MAAM,CAACiB,IAAI;AAC7B;AACA;AACA;AACA;AACA;AACA,CAAC;AAACC,GAAA,GANIF,SAAS;AAQf,MAAMG,QAAQ,GAAGnB,MAAM,CAACoB,QAAQ;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACC,GAAA,GAtBIF,QAAQ;AAwBd,MAAMG,UAAU,GAAGtB,MAAM,CAACuB,MAAM;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACC,GAAA,GAxBIF,UAAU;AA0BhB,MAAMG,UAAU,GAAGzB,MAAM,CAACO,GAAG;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACmB,GAAA,GAfID,UAAU;AAiBhB,MAAME,gBAAgB,GAAG3B,MAAM,CAACO,GAAG;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACqB,GAAA,GAbID,gBAAgB;AAetB,MAAME,kBAAkB,GAAG7B,MAAM,CAACO,GAAG;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACuB,GAAA,GAPID,kBAAkB;AASxB,MAAME,aAAa,GAAG/B,MAAM,CAACO,GAAG;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACyB,GAAA,GAPID,aAAa;AASnB,MAAME,YAAY,GAAGjC,MAAM,CAACkC,EAAE;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACC,IAAA,GAPIF,YAAY;AASlB,MAAMG,eAAe,GAAGpC,MAAM,CAACO,GAAG;AAClC;AACA;AACA;AACA,CAAC;AAAC8B,IAAA,GAJID,eAAe;AAMrB,MAAME,YAAY,GAAGtC,MAAM,CAACuB,MAAM;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACgB,IAAA,GAlBID,YAAY;AAoBlB,MAAME,YAAY,GAAGxC,MAAM,CAACuB,MAAM;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AAACkB,IAAA,GAlBID,YAAY;AAoBlB,MAAME,cAAc,GAAG1C,MAAM,CAACO,GAAG;AACjC,gBAAgBoC,KAAK,IAAIA,KAAK,CAACC,MAAM,GAAG,OAAO,GAAG,GAAG;AACrD;AACA;AA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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}